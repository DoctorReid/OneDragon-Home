---
lang: zh-CN
title: 功能-锄地路线录制
---

该功能未迁移到新版脚本，文档仅做备份留存

## 1.路线编辑

- 新增路线 - 先选择对应的 星球 - 区域 - 层数，此时会加载显示对应的地图。
- 编辑路线 - 左上角可以选择已有路线进行编辑

### 1.1.传送点选择
每条路线，都会以一个 __传送点__ 开始，选择后再开始后续移动路线的绘制。

该部分在文件中保存为类似以下的内容:

```yaml
planet: '空间站黑塔'
region: '基座舱段'
level: 0
tp: '监控室'
```

### 1.2.移动路线
选择好出发的传送点后，只需在地图上点击下一步要前往的位置即可，游戏角色将会从一个坐标点直线地往下一个坐标点移动。

该部分在文件中保存为类似以下的内容：

```yaml
route:
  - op: 'move'
    data: [640, 250]
```

__route__ 属性保存的就是后续需要移动的路线坐标，__op: 'move'__ 代码的是朝模板移动指令，其他指令将在下面阐述。

快捷键`R`可以对当前游戏画面截图，并直接计算坐标，增加一个移动指令到最后。

### 1.3.禁疾跑
表示移动到下一个点时不使用疾跑，适合在交互前一点使用，比秒疾跑错过了交互点。该部分在文件中保存为类似以下的内容：

```yaml
route:
  - op: 'slow_move'
    data: [640, 250]
```

### 1.4.中途切换层数
由于小地图的坐标定位是要和大地图进行匹配得到的，而不同楼层的地图是不一样的，因此脚本需要知道当前楼层来选择对应大地图进行匹配，得到最精准的定位。

如果下一个目标点是别的楼层，在点击地图前，选择切换`中途切换层数`，这时候会加载新楼层的地图，然后再点击地图。

该部分在文件中保存为类似以下的内容：

```yaml
route:
  - op: 'move'
    data: [640, 250, -1]
```

该示例表示：进入这个点后人物在`-1层`。`data`数组没有第三个元素的话说明不需要切换楼层。

### 1.5.攻击怪物

由于脚本目前是串行且非常依赖定位准确，脚本会尽量减少定位以外的运算开销。因此一般移动的情况下，只有被敌人锁定，小地图变`红色`预警时人物会停下来攻击敌人，此时是有可能漏怪的。

因此，我们可以强制标记，点击`攻击怪物`，会在路线当前最后一个点上，停下来尝试攻击敌人。

该部分在文件中保存为类似以下的内容： （该指令没有`data`属性）

```yaml
route:
  - op: 'patrol'
```

快捷键`R`可以对当前游戏画面截图，并直接计算坐标，增加一个移动和攻击怪物指令到最后。

### 1.6.攻击可破坏物

只会发动一次攻击，需精确走到可攻击破坏物的位置。快捷键 数字`5` 可以直接在画面截图并增加坐标

```yaml
route:
  - op: 'disposable'
```

快捷键`H`可以对当前游戏画面截图，并直接计算坐标，增加一个移动和攻击可破坏物指令到最后。


### 1.7.交互
部分路线中途需要进行交互，例如电梯、入画等。先在`交互文本`中填入需要交互的内容，例如`入画`，再点击`交互按钮`，会在当前路线最后一个点上进行交互。

该部分在文件中保存为类似以下的内容：

```yaml
route:
  - op: 'interact'
    data: '入画'
```

### 1.8.等待
部分交互后，游戏中需要一些过场动画，这时可让脚本等待到特定场景出现：

- 主界面 - 人物可以继续行走的界面，右上角有角色图标
- 秒数 - 等待若干秒，不同场景下需要等待的动画时间不同。

该部分在文件中保存为类似以下的内容：

```yaml
route:
  - op: 'wait'
    data: 'in_world'
```

### 1.9. 传送更新坐标
部分交互后，人物会传送到新的地方，这时候需要告诉脚本传送到哪去了。

在落地点上先点击一次，然后再点击` 传送更新坐标`，这时候，路线的最后一个点和上一个点之间将没有连线显示。如果需要顺便切换楼层，可以先点`切换路线楼层`再点坐标。

该部分在文件中保存为类似以下的内容：

```yaml
route:
  - op: 'update_pos'
    data: [573, 319]
```

## 2.保存/测试路线
点击保存后，就可以点击测试路线了。运行测试前，需要手动将大地图缩放到`最小比例`。

测试充分后，可提PR贡献你的路线，作者署名可以写上您的大名，让大家知道您的贡献，匿名提供也替大家谢谢您。

## 3.绘制路线注意事项：
1. 大地图上并没有显示实际游戏中存在的障碍物（箱子、路灯之类的），因此路线需要自行测试再调整，目前脚本简单的脱困功能并不能完全避免障碍物卡死。
2. 经过门、桥、窄道时，应该在两端都选择移动点，尽量保证人物不是斜着进入窄道内的，因为这样容易卡在入口两侧的门或障碍物中。
3. 切换楼层附近的位置是相对容易定位失败的，因此脚本中对会切换楼层的目标点，最多使用两个楼层的大地图进行匹配定位。为提升脚本效率，最好在切换楼层的两端都标记一个路线点，也就是用较短距离横跨楼层，减少需要匹配两个楼层的时间。
4. 由于脚本脱困是先尝试往左右，因为路线绘制应该尽量靠右走。
5. 脚本自动计算坐标是在最后一个坐标点附近开始计算的，距离最后一个坐标点较远时会计算失败或者计算到错误坐标。可以先大概标一个位置，再使用脚本的自动计算坐标功能。
6. 入画等交互之后，应该先等待一定秒数，因为有可能画面还在交互的部分未变动。然后再等待大世界，确认角色可移动后再进行下一步操作。

